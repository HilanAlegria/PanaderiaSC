<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panadería "Sabor Caleño" en Cali</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <header>
        <div class="logo">
            <img src="imagenes/Logo Sabor Caleño.png" alt="Logo" style="height: 30px; vertical-align: middle; margin-right: 10px;">
            <a href="/PanaderiaSC">PANADERIA SABOR CALEÑO</a>
        </div>
        <nav>
            <ul>
                <li><a href="/PanaderiaSC">Inicio</a></li>
                <li><a href="/PanaderiaSC/menu.html" id="cargar-menu">Menú</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="hero">
            <div class="hero-content">
                <h1>El Sabor Auténtico de Cali, Directo a tu Mesa</h1>
                <p>Disfruta de nuestros panes artesanales, pasteles deliciosos y la tradición horneada con amor.</p>
                <a href="/PanaderiaSC/menu.html" id="cargar-menu-hero" class="button destacado">Ver Nuestro Menú</a>
            </div>
            <div class="Variedad">
                <img src="imagenes/Variedad_SC_650x800.png" alt="Variedad de panes y pasteles" style="max-width: 100%; height: auto;">
            </div>
        </section>

        <section class="destacados">
            <h2>Nuestros Favoritos</h2>
            <div class="productos-grid">
                <div class="producto">
                    <img src="imagenes/pan frances.jpeg" alt="Pan Francés">
                    <h3>Pan Francés</h3>
                    <p>Crujiente por fuera, suave por dentro. Un clásico irresistible.</p>
                    <p class="precio">$2.500</p>
                </div>
                <div class="producto">
                    <img src="imagenes/torta de chocolate.jpeg" alt="Torta de Chocolate">
                    <h3>Torta de Chocolate</h3>
                    <p>Un deleite cremoso y profundo sabor a chocolate.</p>
                    <p class="precio">$25.000</p>
                </div>
                <div class="producto">
                    <img src="imagenes/galletas de avena.jpeg" alt="Galletas de Avena">
                    <h3>Galletas de Avena</h3>
                    <p>Saludables y deliciosas, perfectas para cualquier momento.</p>
                    <p class="precio">$3.000</p>
                </div>
                <div class="producto">
                    <img src="imagenes/pastel de avena.jpeg" alt="Pastel de Avena">
                    <h3>Pastel de Avena</h3>
                    <p>Una opción nutritiva y deliciosa para disfrutar.</p>
                    <p class="precio">$18.000</p>
                </div>
            </div>
            <a href="/PanaderiaSC/menu.html" id="cargar-menu-completo" class="button ver-mas">Ver Menú Completo</a>
        </section>

        <section class="sobre-nosotros-principal">
            <div class="sobre-nosotros-content">
                <h2>Un Poco de Nuestra Historia</h2>
                <p>En Sabor Caleño, horneamos tradición desde [Año de Fundación]. Nuestra pasión por el pan artesanal y los sabores auténticos de Cali nos impulsa cada día.</p>
                <p>Valoramos la calidad, la frescura y el cariño en cada uno de nuestros productos. Somos parte de tu comunidad, endulzando tus momentos especiales con el sabor inigualable de nuestra panadería.</p>
                </div>
            <div class="sobre-nosotros-image">
                <img src="imagenes/Panadera trabajando.jpeg" alt="Panaderos trabajando" style="max-width: 100%; height: auto; border-radius: 8px;">
            </div>
        </section>

        <section class="ubicacion">
            <h2>Visítanos en Nuestro Horno en Cali</h2>
            <div class="mapa">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3982.821999089349!2d-76.5199947854895!3d3.405348997513889!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8e30a68c8d241f1f%3A0x9b8a7c1c8b7a8d3a!2s[Tu%20Direcci%C3%B3n%20de%20Panader%C3%ADa]!5e0!3m2!1ses-419!2sco!4v1713173905789!5m2!1ses-419!2sco" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
            </div>
            <p>Estamos ubicados en: [Tu Dirección en Cali]</p>
            <p>Horario: Lunes a Domingo de 6:00 am a 10:00 pm</p>
        </section>

        <section id="contenedor-menu" style="display: none;">
        </section>

        <div class="modal fade" id="cartModal" tabindex="-1" aria-labelledby="cartModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="cartModalLabel">Tu Carrito de Compras</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                    </div>
                    <div class="modal-body">
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Producto</th>
                                    <th>Precio</th>
                                    <th>Cantidad</th>
                                    <th>Total</th>
                                    <th>Acción</th>
                                </tr>
                            </thead>
                            <tbody id="cart-list">
                                <tr><td colspan="5" class="text-center">Cargando...</td></tr>
                            </tbody>
                        </table>
                        <h4 class="text-end">Total: $<span id="cart-total">0</span></h4>
                        <div class="mb-3">
                            <label for="email" class="form-label">Correo electrónico:</label>
                            <input type="email" id="email" class="form-control" placeholder="Ingresa tu correo" required>
                        </div>
                        <div class="mb-3">
                            <label for="name" class="form-label">Nombre:</label>
                            <input type="text" id="name" class="form-control" placeholder="Ingresa tu nombre" required>
                        </div>
                        <div class="mb-3">
                            <label for="gender" class="form-label">Género:</label>
                            <select id="gender" class="form-select" required>
                                <option value="Masculino">Masculino</option>
                                <option value="Femenino">Femenino</option>
                                <option value="No definido">No definido</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="phone" class="form-label">Teléfono:</label>
                            <input type="tel" id="phone" class="form-control" placeholder="Ingresa tu número de teléfono" required>
                        </div>
                        <div class="mb-3">
                            <label for="payment-method" class="form-label">Método de pago:</label>
                            <select id="payment-method" class="form-select" required>
                                <option value="Nequi">Nequi</option>
                                <option value="Bancolombia">Bancolombia</option>
                                <option value="Tarjeta">Tarjeta</option>
                                <option value="PSE">PSE</option>
                                <option value="Efectivo">Efectivo</option>
                            </select>
                        </div>
                        <div class="d-flex justify-content-between">
                            <button class="btn btn-danger" onclick="clearCart()">Vaciar carrito</button>
                            <button class="btn btn-success" onclick="showConfirmationModal()">Realizar Compra</button>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar Carrito</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="confirmationModal" tabindex="-1" aria-labelledby="confirmationModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="confirmationModalLabel">Confirmar Compra</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                    </div>
                    <div class="modal-body" id="modal-body-summary"></div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="button" class="btn btn-success" onclick="checkout()">Confirmar</button>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer>
        <p>© [2025] Sabor Caleño. Todos los derechos reservados.</p>
        <div class="social">
            <a href="https://www.facebook.com/share/16WmorrAAK/" target="_blank" aria-label="Enlace a nuestra página de Facebook">
                <img src="imagenes/icono fb.png" alt="Facebook" style="height: 30px; vertical-align: middle; margin-right: 10px;">
            </a>
            <a href="https://www.instagram.com/h011723?igsh=MWVlZzBmbWFkODIzaQ==" target="_blank" aria-label="Enlace a nuestra cuenta de Instagram">
                <img src="imagenes/icono ig.jpeg" alt="Instagram" style="height: 30px; vertical-align: middle; margin-right: 10px;">
            </a>
        </div>
    </footer>

    <button id="toggleLoginBtn" style="bottom: 90px; right: 20px;">Iniciar Sesión / Acceso Admin</button>

    <div id="login-container">
        <h3>Iniciar Sesión</h3>
        <form id="login-form">
            <label for="login-username">Usuario:</label>
            <input type="text" id="login-username" name="username" required><br>

            <label for="login-password">Contraseña:</label>
            <input type="password" id="login-password" name="password" required><br>

            <button type="submit">Entrar</button>
        </form>
        <p id="login-message" class="login-message"></p>
    </div>

    <a href="#" class="cart-float-button" data-bs-toggle="modal" data-bs-target="#cartModal">
        🛒<span class="badge" id="cart-count">0</span>
    </a>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const cargarMenuBtnNav = document.getElementById('cargar-menu');
            const cargarMenuBtnHero = document.getElementById('cargar-menu-hero');
            const cargarMenuBtnCompleto = document.getElementById('cargar-menu-completo');
            const contenedorMenu = document.getElementById('contenedor-menu');
    
            function cargarMenu(event) {
                event.preventDefault(); // Evita que el enlace navegue
    
                fetch('/PanaderiaSC/menu.html')
                    .then(response => response.text())
                    .then(data => {
                        contenedorMenu.innerHTML = data;
                        contenedorMenu.style.display = 'block';
                        contenedorMenu.scrollIntoView({ behavior: 'smooth' }); // Desplazamiento suave
                        // Después de cargar el menú, inicializa los event listeners para sus botones
                        initializeMenuButtons();
                    })
                    .catch(error => {
                        console.error('Error al cargar el menú:', error);
                        contenedorMenu.innerHTML = '<p>Error al cargar el menú.</p>';
                        contenedorMenu.style.display = 'block';
                    });
            }
    
            cargarMenuBtnNav.addEventListener('click', cargarMenu);
            cargarMenuBtnHero.addEventListener('click', cargarMenu);
            cargarMenuBtnCompleto.addEventListener('click', cargarMenu);

            // Función para inicializar los botones de "Agregar al Carrito" en el menú cargado
            // Se asume que esta función se define en otro script como 'script.js'
            // Si no, necesitarías definirla aquí o asegurarte de que esté disponible globalmente.
            function initializeMenuButtons() {
                const botonesAgregarCarritoMenu = document.querySelectorAll('#contenedor-menu .agregar-carrito');
                botonesAgregarCarritoMenu.forEach(boton => {
                    boton.removeEventListener('click', addProductToCart); // Evitar duplicados
                    boton.addEventListener('click', addProductToCart);
                });
            }

            // Función para añadir producto al carrito (usada por script.js)
            // Se define aquí para que pueda ser llamada desde initializeMenuButtons
            let cart = JSON.parse(localStorage.getItem('cart')) || []; // Asegúrate de que 'cart' esté inicializado
            
            function addProductToCart() {
                const productDiv = this.closest('.menu-item');
                const productId = productDiv.dataset.id;
                const productName = productDiv.dataset.name;
                const productPrice = parseFloat(productDiv.dataset.price);

                const existingItem = cart.find(item => item.id === productId);

                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    cart.push({ id: productId, name: productName, price: productPrice, quantity: 1 });
                }

                saveCart();
                renderCart();
            }

            // Estas funciones (saveCart y renderCart) se asumen que están definidas en 'script.js'
            // o donde manejes la lógica del carrito.
            function saveCart() {
                localStorage.setItem('cart', JSON.stringify(cart));
            }

            function renderCart() {
                // Lógica para renderizar el carrito en el modal
                const cartList = document.getElementById('cart-list');
                const cartTotal = document.getElementById('cart-total');
                const cartCount = document.getElementById('cart-count');

                cartList.innerHTML = '';
                let total = 0;
                let count = 0;

                if (cart.length === 0) {
                    cartList.innerHTML = '<tr><td colspan="5" class="text-center">El carrito está vacío.</td></tr>';
                } else {
                    cart.forEach(item => {
                        const row = document.createElement('tr');
                        const itemTotalPrice = item.price * item.quantity;
                        row.innerHTML = `
                            <td>${item.name}</td>
                            <td>$${item.price.toLocaleString('es-CO')}</td>
                            <td>
                                <input type="number" class="form-control form-control-sm" value="${item.quantity}" min="1" 
                                    onchange="updateCartQuantity('${item.id}', this.value)">
                            </td>
                            <td>$${itemTotalPrice.toLocaleString('es-CO')}</td>
                            <td>
                                <button class="btn btn-danger btn-sm" onclick="removeFromCart('${item.id}')">Eliminar</button>
                            </td>
                        `;
                        cartList.appendChild(row);
                        total += itemTotalPrice;
                        count += item.quantity;
                    });
                }
                cartTotal.textContent = total.toLocaleString('es-CO');
                cartCount.textContent = count;
            }

            // Funciones globales para actualizar y eliminar del carrito (si son necesarias fuera del script.js)
            window.updateCartQuantity = function(productId, quantity) {
                const item = cart.find(i => i.id === productId);
                if (item) {
                    item.quantity = parseInt(quantity);
                    if (item.quantity <= 0) {
                        removeFromCart(productId);
                    } else {
                        saveCart();
                        renderCart();
                    }
                }
            };

            window.removeFromCart = function(productId) {
                cart = cart.filter(item => item.id !== productId);
                saveCart();
                renderCart();
            };

            window.clearCart = function() {
                cart = [];
                saveCart();
                renderCart();
            };

            window.showConfirmationModal = function() {
                const email = document.getElementById('email').value;
                const name = document.getElementById('name').value;
                const gender = document.getElementById('gender').value;
                const phone = document.getElementById('phone').value;
                const paymentMethod = document.getElementById('payment-method').value;

                if (!email || !name || !phone) {
                    alert('Por favor, completa todos los campos de información personal.');
                    return;
                }

                if (cart.length === 0) {
                    alert('Tu carrito está vacío. No puedes realizar una compra.');
                    return;
                }

                const modalBodySummary = document.getElementById('modal-body-summary');
                let summaryHtml = '<h5>Resumen de tu Pedido:</h5><ul>';
                cart.forEach(item => {
                    summaryHtml += `<li>${item.name} x ${item.quantity} - $${(item.price * item.quantity).toLocaleString('es-CO')}</li>`;
                });
                summaryHtml += `</ul><p><strong>Total a Pagar: $${document.getElementById('cart-total').textContent}</strong></p>`;
                summaryHtml += `<h6>Tus Datos:</h6>
                                <p><strong>Nombre:</strong> ${name}</p>
                                <p><strong>Correo:</strong> ${email}</p>
                                <p><strong>Género:</strong> ${gender}</p>
                                <p><strong>Teléfono:</strong> ${phone}</p>
                                <p><strong>Método de Pago:</strong> ${paymentMethod}</p>`;
                modalBodySummary.innerHTML = summaryHtml;

                const confirmationModal = new bootstrap.Modal(document.getElementById('confirmationModal'));
                confirmationModal.show();
            };

            window.checkout = function() {
                alert('¡Compra realizada con éxito! Nos pondremos en contacto contigo para la entrega.');
                clearCart();
                const cartModal = bootstrap.Modal.getInstance(document.getElementById('cartModal'));
                if (cartModal) {
                    cartModal.hide();
                }
                const confirmationModal = bootstrap.Modal.getInstance(document.getElementById('confirmationModal'));
                if (confirmationModal) {
                    confirmationModal.hide();
                }
            };
            
            // Renderiza el carrito al cargar la página
            renderCart();
        });
    </script>
    <script src="script.js"></script>

    <script src="js/main.js"></script>

</body>
</html>